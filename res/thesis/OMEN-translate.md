# OMEN: 基于马尔科夫模型可能性递减序列的更快速的密码猜测方法

## 摘要
密码被广泛运用在用户验证，尽管现在一些密码安全性较差，但是它还将在可预见的未来中长久的发挥功能。密码安全性较差的重要原因是用户创造密码的时候太有规律可循，使得太容易受到密码猜测攻击。理解攻击者的密码猜测攻击的方法是非常重要，也是非常必需的，这样我们才能更好的寻找对策来抑制他们的攻击。

这篇文章使用流行的 OMEN 方法，即被 Narayanan 和 Shmatikov（CCS 2005）提出的一种新的基于马尔科夫模型的密码破解方法。主要的创新点是我们的工具在生成密码时是根据它们最近的出现概率，并且首先生成的密码更像是“密码”。我们大量的实验表明， 相比较与现有的一些方法，OMEN 显著的提升了密码猜测速度。

我们还针对 Narayanan 和 Shmatikov 使用的John the Ripper 的马尔科夫模型做了性能对比实验。OMEN 猜测方法在第一组9000万次猜测中的正确率提高了40%，而John the Ripper 的马尔科夫模型需要至少8倍的猜测量才能达到同等的正确率。并且 OMEN 猜测方法在 100 亿次猜测中超过了我们比较的所有的密码猜测方法。

> 关键词：验证、密码猜测、马尔科夫方法

## 1 介绍
无论是在线还是离线，基于密码的用户验证都是最广泛的运用于用户验证的方法。尽管有一些密码安全性较差，在可预见的未来，密码还将会是用户验证的最主要的一种形式，因为大量的优点：密码有高可移植性，易于被用户理解，易于被开发者管理。事实上，可选择性的用户验证形式有在特殊的场景当中替代密码的能力，虽然现在他们还不行，但是将来能在大范围的场景当中替代密码。

在这次工作中，我们专注于离线的密码猜测攻击，攻击者可以进行大量的密码猜测，仅仅受限于工作者愿意投入的时间和资源。这种攻击是可以通过攻击者提高生成和验证猜测的计算资源来大幅度提高速度的，比如使用特定的硬件设施和大量的计算资源等。我们专注于通过技术来减少破解密码需要的猜测次数。因此，我们的目标是在不依赖于充足的资源的情况下减少攻击次数。

类似于字典模型中的 John the Ripper (JtR) (对现存的单词字段使用 mangling rules 来挖掘密码的结构规律)这类工具是非常常用的，这被用来通过现有的字典或者最近泄漏的密码数据库之类的数据全集来生成新的密码。 Weir et al. 示范了如何使用上下文无关文法（PCFG）来从泄漏的密码数据库中自动获取 mangling 规则，Narayanan et al 展示了因为与自然语言处理紧紧相关而闻名的马尔科夫模型，也能被用来高效的猜测密码。我们将证明虽然这些攻击方法已经能获得一个高效的密码破解，但是他们的性能还是能有实质性的提升。

这篇文章将介绍 OMEN , 一种新的基于马尔科夫模型的攻击，通过最近出现的可能性来生成密码，生成的密码更接近真正的“密码”。通过我们大量的实验， 比起现存的方法，OMEN 显著的提高了猜测速度。

## 1.1 相关工作
密码存在一个很大的问题是用户可能选择一个安全性很弱的密码。这些密码普遍有极强的结构性，所以可以被粗暴的密码猜测攻击更快速的攻破。为了保护在数据库被攻破时泄漏的纯文本信息，最好的授权实现是仅把 hash 以后的密码保存在服务器中，而不是明文密码。

在这次工作当中，我们考虑离线的猜测攻击，并且假设攻击者已经获得了 hash 方法并且恢复了密码。hash 函数通常被设计来降低攻击者猜测的企图，这意味着泄漏的风险主要受 hash 函数的计算代价主导。所以我们为了用更小的代价来猜测一个新的密码，我们在评估所有的攻击者的时候我们基于它进行猜测直到猜测正确的次数。


**John the Ripper:** John the Ripper (JtR) 是一个非常著名的密码攻击者。它经常提出不同的方法来生成密码。在字典模型中，一个单词字典作为提供的输入，这个工具可以对其中的所有单词进行测试。用户能特定多种不同的 mangling 规则。就像 [6]， 我们发现小部分相关联的猜测（少于 10^8），在字典模型当中，JtR 是最好的规则，在加强的模型（JtR-inc）中，JtR 尝试通过3层的马尔科夫模型来猜测密码。

**Password Guessing with Markov Models:** 马尔科夫模型已经证明其在计算机安全领域，特别是密码安全领域非常的有用。我们有一个很有用的工具去破解密码，并且我们同样能用它来正确的估计新密码的安全强度。最近一个独立的工作比较了不同的几种概率密码模型，并且得出结论，相比上下文无关文法模型，马尔科夫模型是更适合来估计密码概率。我们的工作和他们相比最大的不同是，他们仅使用类似的密码，
没有制作出一个产出正确密码顺序的密码攻击者。但这是我们工作的主要贡献。

马尔科夫模型的基本思想是密码中的毗邻的字母不是独立的选择，而是遵循一种确定的规律（比如2阶的 th 比起 tq 是有更高的可能性的，e 有很高的可能性出现在 th 后面）。在 n 阶的马尔科夫模型当中，字符串中下一个字符出现的概率基于以前的 n - 1 个字符。因此，对于给定的字符串 c1,...,cm，马尔科夫模型估算的概率是 []。对于密码攻击，需要通过真实的数据集知道初始概率 [] 和转移概率 [] （它应该尽可能的接近我们攻击的数据的分布），然后按马尔科夫模型估计的可能性递减顺序枚举密码。为了使得攻击高效，我们需要考虑一些细节，有限的数据是一个挑战（数据稀少），最优的密码枚举顺序是一个挑战。

**Probabilistic Grammars-Based Schemes:** 一个基于概率的上下文无关文法，该方法首先假设典型的密码有确定的结构。通过一系列真实的密码数据来获得不同结构的可能性，然后使用这些结构来生成密码。


**Password Strength Estimation：**
